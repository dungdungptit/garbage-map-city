{
    "sourceFile": "majestic/Dashboard/js/map.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 25,
            "patches": [
                {
                    "date": 1650741763016,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1650741772530,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -504,4 +504,7 @@\n         \r\n     }, 200);\r\n }, 500);\r\n \r\n+onclick() {\r\n+    \r\n+}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1650741783820,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -505,6 +505,6 @@\n     }, 200);\r\n }, 500);\r\n \r\n onclick() {\r\n-    \r\n+    console\r\n }\n\\ No newline at end of file\n"
                },
                {
                    "date": 1650742364897,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -503,8 +503,4 @@\n         layerGrVehicle = L.layerGroup(objVehicle).addTo(map);\r\n         \r\n     }, 200);\r\n }, 500);\r\n-\r\n-onclick() {\r\n-    console\r\n-}\n\\ No newline at end of file\n"
                },
                {
                    "date": 1650743472012,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -220,9 +220,8 @@\n                 // console.log(data);\r\n             });\r\n \r\n         }, 500*i);\r\n-\r\n     }\r\n }\r\n updateService(dataTemporary);\r\n \r\n"
                },
                {
                    "date": 1650743602880,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -218,12 +218,12 @@\n                 long: dataTemporary[i][1]\r\n             }, function (data) {\r\n                 // console.log(data);\r\n             });\r\n-\r\n         }, 500*i);\r\n     }\r\n }\r\n+\r\n updateService(dataTemporary);\r\n \r\n // function loadname(){\r\n //     $.getJSON('/majestic/Dashboard/php/api/post/R_temporary.php',{},function (data) {\r\n"
                },
                {
                    "date": 1650794579110,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -221,21 +221,10 @@\n             });\r\n         }, 500*i);\r\n     }\r\n }\r\n-\r\n updateService(dataTemporary);\r\n \r\n-// function loadname(){\r\n-//     $.getJSON('/majestic/Dashboard/php/api/post/R_temporary.php',{},function (data) {\r\n-//         // console.log(data);\r\n-//         $(\"#display-username\").text(data[\"username\"]);\r\n-//         // $(\"#display-fullname\").text('Welcome back ' + data[\"fullname\"]);\r\n-//     });\r\n-// }\r\n-// window.onload=loadname;\r\n-// Define map\r\n-\r\n var cities = L.layerGroup();\r\n var mLittleton = L.marker([21.1227, 105.7532], { icon: iconRed }).bindPopup('This is Littleton, CO.').addTo(cities);\r\n var mDenver = L.marker([21.0046, 105.8529], { icon: iconRed }).bindPopup('This is Denver, CO.').addTo(cities);\r\n var mAurora = L.marker([21.1108, 105.852], { icon: iconRed }).bindPopup('This is Aurora, CO.').addTo(cities);\r\n"
                },
                {
                    "date": 1650794592809,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -254,19 +254,8 @@\n     layers: [streets]\r\n     // layers: [googleStreets, cities]\r\n });\r\n \r\n-// var control = L.Routing.control({\r\n-//     waypoints: [\r\n-//         L.latLng(21.0419, 105.821),\r\n-//         L.latLng(21.0382, 105.825)\r\n-//     ],\r\n-//     routeWhileDragging: true,\r\n-//     // createMarker: function () {\r\n-//     //     return null;\r\n-//     // }\r\n-// }).addTo(map);\r\n-\r\n var xxx = L.polyline(dataTemporary).addTo(map);\r\n \r\n map.setView([21.037181, 105.833485], 15);\r\n \r\n"
                },
                {
                    "date": 1650794742234,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -251,9 +251,8 @@\n var map = L.map('map', {\r\n     center: [21.57201, 105.61388],\r\n     maxZoom: 20,\r\n     layers: [streets]\r\n-    // layers: [googleStreets, cities]\r\n });\r\n \r\n var xxx = L.polyline(dataTemporary).addTo(map);\r\n \r\n@@ -465,9 +464,9 @@\n                 console.log(\"Update\");\r\n             }\r\n             if (objVehicle[i].options.rotationAngle == 0) {\r\n                 objVehicle[i].setRotationAngle(objLatlngs[i].angle);\r\n-                objVehicle[i].setRotationOrigin(16 + 'px ' + 35 + 'px');\r\n+                objVehicle[i].setRotationOrigin(17 + 'px ' + 35 + 'px');\r\n             }\r\n             console.log(objVehicle[i].options.rotationAngle);\r\n         }\r\n         if (layerGrBin) {\r\n"
                },
                {
                    "date": 1650794747776,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -464,9 +464,9 @@\n                 console.log(\"Update\");\r\n             }\r\n             if (objVehicle[i].options.rotationAngle == 0) {\r\n                 objVehicle[i].setRotationAngle(objLatlngs[i].angle);\r\n-                objVehicle[i].setRotationOrigin(17 + 'px ' + 35 + 'px');\r\n+                objVehicle[i].setRotationOrigin(17 + 'px ' + 8 + 'px');\r\n             }\r\n             console.log(objVehicle[i].options.rotationAngle);\r\n         }\r\n         if (layerGrBin) {\r\n"
                },
                {
                    "date": 1650794763659,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -286,13 +286,13 @@\n     iconSize: [25, 41],\r\n });\r\n var iconVehicleRed = L.icon({\r\n     iconUrl: './images/red-vehicle.png',\r\n-    iconSize: [16, 35],\r\n+    iconSize: [35],\r\n });\r\n var iconVehicleGreen = L.icon({\r\n     iconUrl: './images/green-vehicle.png',\r\n-    iconSize: [16, 35],\r\n+    iconSize: [35],\r\n });\r\n \r\n (function() {\r\n     // save these original methods before they are overwritten\r\n"
                },
                {
                    "date": 1650794818133,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -286,13 +286,13 @@\n     iconSize: [25, 41],\r\n });\r\n var iconVehicleRed = L.icon({\r\n     iconUrl: './images/red-vehicle.png',\r\n-    iconSize: [35],\r\n+    iconSize: [35, 16],\r\n });\r\n var iconVehicleGreen = L.icon({\r\n     iconUrl: './images/green-vehicle.png',\r\n-    iconSize: [35],\r\n+    iconSize: [35, 16],\r\n });\r\n \r\n (function() {\r\n     // save these original methods before they are overwritten\r\n@@ -330,9 +330,9 @@\n \r\n                 if (oldIE) {\r\n                     // for IE 9, use the 2D rotation\r\n                     this._icon.style[L.DomUtil.TRANSFORM] = 'rotate(' + this.options.rotationAngle + 'deg)';\r\n-                    // this._icon.style[L.DomUtil.TRANSITION] = 'all 2s linear';\r\n+                    this._icon.style[L.DomUtil.TRANSITION] = 'all 2s linear';\r\n                 } else {\r\n                     // for modern browsers, prefer the 3D accelerated version\r\n                     this._icon.style[L.DomUtil.TRANSFORM] += ' rotateZ(' + this.options.rotationAngle + 'deg)';\r\n                     // this._icon.style[L.DomUtil.TRANSITION] = 'all 2s linear';\r\n"
                },
                {
                    "date": 1650794824966,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -330,13 +330,13 @@\n \r\n                 if (oldIE) {\r\n                     // for IE 9, use the 2D rotation\r\n                     this._icon.style[L.DomUtil.TRANSFORM] = 'rotate(' + this.options.rotationAngle + 'deg)';\r\n-                    this._icon.style[L.DomUtil.TRANSITION] = 'all 2s linear';\r\n+                    this._icon.style[L.DomUtil.TRANSITION] = 'all 1s linear';\r\n                 } else {\r\n                     // for modern browsers, prefer the 3D accelerated version\r\n                     this._icon.style[L.DomUtil.TRANSFORM] += ' rotateZ(' + this.options.rotationAngle + 'deg)';\r\n-                    // this._icon.style[L.DomUtil.TRANSITION] = 'all 2s linear';\r\n+                    this._icon.style[L.DomUtil.TRANSITION] = 'all 1s linear';\r\n                 }\r\n             }\r\n         },\r\n \r\n"
                },
                {
                    "date": 1650794838819,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -478,5 +478,5 @@\n         layerGrBin = L.layerGroup(objBin).addTo(map);\r\n         layerGrVehicle = L.layerGroup(objVehicle).addTo(map);\r\n         \r\n     }, 200);\r\n-}, 500);\r\n+}, 1000);\r\n"
                },
                {
                    "date": 1650795122533,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -477,6 +477,6 @@\n         }\r\n         layerGrBin = L.layerGroup(objBin).addTo(map);\r\n         layerGrVehicle = L.layerGroup(objVehicle).addTo(map);\r\n         \r\n-    }, 200);\r\n-}, 1000);\r\n+    }, 500);\r\n+}, 300);\r\n"
                },
                {
                    "date": 1650795168757,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -477,6 +477,6 @@\n         }\r\n         layerGrBin = L.layerGroup(objBin).addTo(map);\r\n         layerGrVehicle = L.layerGroup(objVehicle).addTo(map);\r\n         \r\n-    }, 500);\r\n-}, 300);\r\n+    }, 100);\r\n+}, 500);\r\n"
                },
                {
                    "date": 1650795401602,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -415,15 +415,9 @@\n         for (let i = 0; i < data.data.length; i++) {\r\n             oB = {\r\n                 lat: data.data[i].lat,\r\n                 long: data.data[i].long,\r\n-                markerBin: L.marker([data.data[i].lat, data.data[i].long]).bindPopup(\r\n-                \"ID: \"+data.data[i].id +\"<br>\" +\r\n-                \"addresses: \"+data.data[i].addresses +\"<br>\" +\r\n-                \"createddate: \"+data.data[i].createddate +\"<br>\" +\r\n-                \"lat: \"+data.data[i].lat +\"<br>\" +\r\n-                \"long: \"+data.data[i].long +\"<br>\" +\r\n-                \"statuses: \"+data.data[i].statuses +\"<br>\"\r\n+                markerBin: L.marker([data.data[i].lat, data.data[i].long])\r\n                 ).openPopup()\r\n             };\r\n             oB.markerBin.setIcon(statBin[data.data[i].statuses]);\r\n             objBin.push(oB.markerBin);\r\n@@ -477,6 +471,6 @@\n         }\r\n         layerGrBin = L.layerGroup(objBin).addTo(map);\r\n         layerGrVehicle = L.layerGroup(objVehicle).addTo(map);\r\n         \r\n-    }, 100);\r\n+    }, 300);\r\n }, 500);\r\n"
                },
                {
                    "date": 1650795409959,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -416,9 +416,9 @@\n             oB = {\r\n                 lat: data.data[i].lat,\r\n                 long: data.data[i].long,\r\n                 markerBin: L.marker([data.data[i].lat, data.data[i].long])\r\n-                ).openPopup()\r\n+                )\r\n             };\r\n             oB.markerBin.setIcon(statBin[data.data[i].statuses]);\r\n             objBin.push(oB.markerBin);\r\n         }\r\n"
                },
                {
                    "date": 1650795419674,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -212,15 +212,15 @@\n     for (let i = 0; i < dataTemporary.length; i++) {\r\n         // console.log(dataTemporary[i][0], dataTemporary[i][1]);\r\n         setTimeout(function () {\r\n             $.getJSON(\"/majestic/Dashboard/php/api/post/update_service.php\", {\r\n-                id:id,\r\n+                id: id,\r\n                 lat: dataTemporary[i][0],\r\n                 long: dataTemporary[i][1]\r\n             }, function (data) {\r\n                 // console.log(data);\r\n             });\r\n-        }, 500*i);\r\n+        }, 500 * i);\r\n     }\r\n }\r\n updateService(dataTemporary);\r\n \r\n@@ -239,11 +239,11 @@\n \r\n var mylayers = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {\r\n     attribution: '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n })\r\n-var googleStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}',{\r\n+var googleStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}', {\r\n     maxZoom: 20,\r\n-    subdomains:['mt0','mt1','mt2','mt3']\r\n+    subdomains: ['mt0', 'mt1', 'mt2', 'mt3']\r\n });\r\n // Hybrid: s,h;\r\n // Satellite: s;\r\n // Streets: m;\r\n@@ -293,16 +293,16 @@\n     iconUrl: './images/green-vehicle.png',\r\n     iconSize: [35, 16],\r\n });\r\n \r\n-(function() {\r\n+(function () {\r\n     // save these original methods before they are overwritten\r\n     var proto_initIcon = L.Marker.prototype._initIcon;\r\n     var proto_setPos = L.Marker.prototype._setPos;\r\n \r\n     var oldIE = (L.DomUtil.TRANSFORM === 'msTransform');\r\n \r\n-    L.Marker.addInitHook(function() {\r\n+    L.Marker.addInitHook(function () {\r\n         var iconOptions = this.options.icon && this.options.icon.options;\r\n         var iconAnchor = iconOptions && this.options.icon.options.iconAnchor;\r\n         if (iconAnchor) {\r\n             iconAnchor = (iconAnchor[0] + 'px ' + iconAnchor[1] + 'px');\r\n@@ -310,22 +310,22 @@\n         this.options.rotationOrigin = this.options.rotationOrigin || iconAnchor || 'center center';\r\n         this.options.rotationAngle = this.options.rotationAngle || 0;\r\n \r\n         // Ensure marker keeps rotated during dragging\r\n-        this.on('drag', function(e) { e.target._applyRotation(); });\r\n+        this.on('drag', function (e) { e.target._applyRotation(); });\r\n     });\r\n \r\n     L.Marker.include({\r\n-        _initIcon: function() {\r\n+        _initIcon: function () {\r\n             proto_initIcon.call(this);\r\n         },\r\n \r\n-        _setPos: function(pos) {\r\n+        _setPos: function (pos) {\r\n             proto_setPos.call(this, pos);\r\n             this._applyRotation();\r\n         },\r\n \r\n-        _applyRotation: function() {\r\n+        _applyRotation: function () {\r\n             if (this.options.rotationAngle) {\r\n                 this._icon.style[L.DomUtil.TRANSFORM + 'Origin'] = this.options.rotationOrigin;\r\n \r\n                 if (oldIE) {\r\n@@ -339,15 +339,15 @@\n                 }\r\n             }\r\n         },\r\n \r\n-        setRotationAngle: function(angle) {\r\n+        setRotationAngle: function (angle) {\r\n             this.options.rotationAngle = angle;\r\n             this.update();\r\n             return this;\r\n         },\r\n \r\n-        setRotationOrigin: function(origin) {\r\n+        setRotationOrigin: function (origin) {\r\n             this.options.rotationOrigin = origin;\r\n             this.update();\r\n             return this;\r\n         }\r\n@@ -407,18 +407,17 @@\n var objVehicle = [];\r\n var layerGrBin, layerGrVehicle;\r\n var oB = new Object();\r\n var oV = new Object();\r\n-setInterval(function() {\r\n+setInterval(function () {\r\n     objBin = [];\r\n     $.getJSON('/majestic/Dashboard/php/api/post/R_bin.php', {}, (data) => {\r\n-        \r\n+\r\n         for (let i = 0; i < data.data.length; i++) {\r\n             oB = {\r\n                 lat: data.data[i].lat,\r\n                 long: data.data[i].long,\r\n                 markerBin: L.marker([data.data[i].lat, data.data[i].long])\r\n-                )\r\n             };\r\n             oB.markerBin.setIcon(statBin[data.data[i].statuses]);\r\n             objBin.push(oB.markerBin);\r\n         }\r\n@@ -431,23 +430,23 @@\n             oV = {\r\n                 lat: data.data[i].lat,\r\n                 long: data.data[i].long,\r\n                 markerVehicle: L.marker([data.data[i].lat, data.data[i].long]).bindPopup(\r\n-                \"ID: \"+data.data[i].id +\"<br>\" +\r\n-                // \"typed: \"+data.data[i].typed +\"<br>\" +\r\n-                \"license: \"+data.data[i].license +\"<br>\" +\r\n-                // \"code: \"+data.data[i].code +\"<br>\" +\r\n-                \"lat: \"+data.data[i].lat +\"<br>\" +\r\n-                \"long: \"+data.data[i].long +\"<br>\" +\r\n-                \"addresses: \"+data.data[i].addresses +\"<br>\" +\r\n-                \"statuses: \"+data.data[i].statuses +\"<br>\"\r\n+                    \"ID: \" + data.data[i].id + \"<br>\" +\r\n+                    // \"typed: \"+data.data[i].typed +\"<br>\" +\r\n+                    \"license: \" + data.data[i].license + \"<br>\" +\r\n+                    // \"code: \"+data.data[i].code +\"<br>\" +\r\n+                    \"lat: \" + data.data[i].lat + \"<br>\" +\r\n+                    \"long: \" + data.data[i].long + \"<br>\" +\r\n+                    \"addresses: \" + data.data[i].addresses + \"<br>\" +\r\n+                    \"statuses: \" + data.data[i].statuses + \"<br>\"\r\n                 ).openPopup()\r\n             }\r\n             oV.markerVehicle.setIcon(statVehicle[data.data[i].statuses]);\r\n             objVehicle.push(oV.markerVehicle);\r\n         }\r\n     });\r\n-    setTimeout(function() {\r\n+    setTimeout(function () {\r\n         for (let i = 0; i < objVehicle.length; i++) {\r\n             if (objVehicle[i]._latlng.lat !== objLatlngs[i].lat || objVehicle[i]._latlng.lng !== objLatlngs[i].long) {\r\n                 let angle = _getAngle(objLatlngs[i].long, objLatlngs[i].lat, objVehicle[i]._latlng.lng, objVehicle[i]._latlng.lat);\r\n                 // objVehicle[i].setRotationAngle(angle);\r\n@@ -470,7 +469,7 @@\n             map.removeLayer(layerGrVehicle);\r\n         }\r\n         layerGrBin = L.layerGroup(objBin).addTo(map);\r\n         layerGrVehicle = L.layerGroup(objVehicle).addTo(map);\r\n-        \r\n+\r\n     }, 300);\r\n }, 500);\r\n"
                },
                {
                    "date": 1650795425734,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -429,18 +429,9 @@\n         for (let i = 0; i < data.data.length; i++) {\r\n             oV = {\r\n                 lat: data.data[i].lat,\r\n                 long: data.data[i].long,\r\n-                markerVehicle: L.marker([data.data[i].lat, data.data[i].long]).bindPopup(\r\n-                    \"ID: \" + data.data[i].id + \"<br>\" +\r\n-                    // \"typed: \"+data.data[i].typed +\"<br>\" +\r\n-                    \"license: \" + data.data[i].license + \"<br>\" +\r\n-                    // \"code: \"+data.data[i].code +\"<br>\" +\r\n-                    \"lat: \" + data.data[i].lat + \"<br>\" +\r\n-                    \"long: \" + data.data[i].long + \"<br>\" +\r\n-                    \"addresses: \" + data.data[i].addresses + \"<br>\" +\r\n-                    \"statuses: \" + data.data[i].statuses + \"<br>\"\r\n-                ).openPopup()\r\n+                markerVehicle: L.marker([data.data[i].lat, data.data[i].long])\r\n             }\r\n             oV.markerVehicle.setIcon(statVehicle[data.data[i].statuses]);\r\n             objVehicle.push(oV.markerVehicle);\r\n         }\r\n"
                },
                {
                    "date": 1650795435380,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -439,10 +439,10 @@\n     setTimeout(function () {\r\n         for (let i = 0; i < objVehicle.length; i++) {\r\n             if (objVehicle[i]._latlng.lat !== objLatlngs[i].lat || objVehicle[i]._latlng.lng !== objLatlngs[i].long) {\r\n                 let angle = _getAngle(objLatlngs[i].long, objLatlngs[i].lat, objVehicle[i]._latlng.lng, objVehicle[i]._latlng.lat);\r\n-                // objVehicle[i].setRotationAngle(angle);\r\n-                // objVehicle[i].setRotationOrigin(16 + 'px ' + 35 + 'px');\r\n+                objVehicle[i].setRotationAngle(angle);\r\n+                objVehicle[i].setRotationOrigin(16 + 'px ' + 35 + 'px');\r\n                 objLatlngs[i].angle = angle;\r\n                 objLatlngs[i].lat = objVehicle[i]._latlng.lat;\r\n                 objLatlngs[i].long = objVehicle[i]._latlng.lng;\r\n                 console.log(\"Update\");\r\n"
                },
                {
                    "date": 1650795447215,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -440,9 +440,9 @@\n         for (let i = 0; i < objVehicle.length; i++) {\r\n             if (objVehicle[i]._latlng.lat !== objLatlngs[i].lat || objVehicle[i]._latlng.lng !== objLatlngs[i].long) {\r\n                 let angle = _getAngle(objLatlngs[i].long, objLatlngs[i].lat, objVehicle[i]._latlng.lng, objVehicle[i]._latlng.lat);\r\n                 objVehicle[i].setRotationAngle(angle);\r\n-                objVehicle[i].setRotationOrigin(16 + 'px ' + 35 + 'px');\r\n+                objVehicle[i].setRotationOrigin(17 + 'px ' + 8 + 'px');\r\n                 objLatlngs[i].angle = angle;\r\n                 objLatlngs[i].lat = objVehicle[i]._latlng.lat;\r\n                 objLatlngs[i].long = objVehicle[i]._latlng.lng;\r\n                 console.log(\"Update\");\r\n"
                },
                {
                    "date": 1650795454362,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -463,4 +463,5 @@\n         layerGrVehicle = L.layerGroup(objVehicle).addTo(map);\r\n \r\n     }, 300);\r\n }, 500);\r\n+\r\n"
                },
                {
                    "date": 1650807111897,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -415,9 +415,9 @@\n         for (let i = 0; i < data.data.length; i++) {\r\n             oB = {\r\n                 lat: data.data[i].lat,\r\n                 long: data.data[i].long,\r\n-                markerBin: L.marker([data.data[i].lat, data.data[i].long])\r\n+                markerBin: L.marker([data.data[i].lat, data.data[i].long]).\r\n             };\r\n             oB.markerBin.setIcon(statBin[data.data[i].statuses]);\r\n             objBin.push(oB.markerBin);\r\n         }\r\n"
                },
                {
                    "date": 1650807119888,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -415,9 +415,9 @@\n         for (let i = 0; i < data.data.length; i++) {\r\n             oB = {\r\n                 lat: data.data[i].lat,\r\n                 long: data.data[i].long,\r\n-                markerBin: L.marker([data.data[i].lat, data.data[i].long]).onclick\r\n+                markerBin: L.marker([data.data[i].lat, data.data[i].long]).onclick()\r\n             };\r\n             oB.markerBin.setIcon(statBin[data.data[i].statuses]);\r\n             objBin.push(oB.markerBin);\r\n         }\r\n"
                },
                {
                    "date": 1650807125629,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -415,9 +415,9 @@\n         for (let i = 0; i < data.data.length; i++) {\r\n             oB = {\r\n                 lat: data.data[i].lat,\r\n                 long: data.data[i].long,\r\n-                markerBin: L.marker([data.data[i].lat, data.data[i].long]).\r\n+                markerBin: L.marker([data.data[i].lat, data.data[i].long]).a\r\n             };\r\n             oB.markerBin.setIcon(statBin[data.data[i].statuses]);\r\n             objBin.push(oB.markerBin);\r\n         }\r\n"
                }
            ],
            "date": 1650741763015,
            "name": "Commit-0",
            "content": "var dataTemporary = [[21.0419, 105.821],\r\n[21.04188, 105.82111],\r\n[21.04186, 105.82137],\r\n[21.04183, 105.82157],\r\n[21.04182, 105.82168],\r\n[21.04179, 105.82188],\r\n[21.04173, 105.82209],\r\n[21.04165, 105.82235],\r\n[21.04158, 105.82258],\r\n[21.04156, 105.82263],\r\n[21.04155, 105.82265],\r\n[21.04147, 105.82285],\r\n[21.04143, 105.82296],\r\n[21.04141, 105.82301],\r\n[21.04129, 105.82333],\r\n[21.0412, 105.82351],\r\n[21.04114, 105.82361],\r\n[21.04113, 105.82365],\r\n[21.04105, 105.82384],\r\n[21.041, 105.82393],\r\n[21.0409, 105.82425],\r\n[21.04085, 105.82441],\r\n[21.04083, 105.82444],\r\n[21.04077, 105.82462],\r\n[21.04076, 105.82463],\r\n[21.0407, 105.8248],\r\n[21.04066, 105.82491],\r\n[21.04057, 105.82516],\r\n[21.04052, 105.82529],\r\n[21.04045, 105.82548],\r\n[21.0404, 105.82562],\r\n[21.04037, 105.82576],\r\n[21.04031, 105.82595],\r\n[21.04023, 105.82618],\r\n[21.04019, 105.8263],\r\n[21.04016, 105.82637],\r\n[21.04009, 105.82653],\r\n[21.04007, 105.82656],\r\n[21.04, 105.82671],\r\n[21.03995, 105.82683],\r\n[21.03986, 105.82702],\r\n[21.03983, 105.82708],\r\n[21.03977, 105.82731],\r\n[21.03972, 105.82748],\r\n[21.03965, 105.82769],\r\n[21.03959, 105.82802],\r\n[21.03952, 105.82841],\r\n[21.03952, 105.8285],\r\n[21.03953, 105.8286],\r\n[21.03957, 105.82871],\r\n[21.03957, 105.82871],\r\n[21.03946, 105.82874],\r\n[21.03921, 105.82882],\r\n[21.03918, 105.82883],\r\n[21.03881, 105.829],\r\n[21.03866, 105.82904],\r\n[21.03841, 105.82913],\r\n[21.03839, 105.8292],\r\n[21.03836, 105.82925],\r\n[21.03823, 105.82966],\r\n[21.03818, 105.82972],\r\n[21.03806, 105.82977],\r\n[21.03785, 105.82976],\r\n[21.03776, 105.8299],\r\n[21.03776, 105.83003],\r\n[21.03776, 105.8302],\r\n[21.03775, 105.83051],\r\n[21.03777, 105.83096],\r\n[21.03772, 105.83102],\r\n[21.03767, 105.83105],\r\n[21.03755, 105.83109],\r\n[21.03751, 105.83109],\r\n[21.03747, 105.83109],\r\n[21.0374, 105.83109],\r\n[21.03712, 105.8311],\r\n[21.03677, 105.8311],\r\n[21.03657, 105.8311],\r\n[21.0365, 105.83112],\r\n[21.03637, 105.83116],\r\n[21.03621, 105.83121],\r\n[21.03596, 105.83129],\r\n[21.03583, 105.83133],\r\n[21.03525, 105.83149],\r\n[21.03512, 105.83153],\r\n[21.03495, 105.83159],\r\n[21.03486, 105.83162],\r\n[21.03481, 105.83163],\r\n[21.0347, 105.83167],\r\n[21.03466, 105.83167],\r\n[21.03452, 105.8317],\r\n[21.03446, 105.83171],\r\n[21.03446, 105.83171],\r\n[21.03442, 105.83162],\r\n[21.03442, 105.83157],\r\n[21.03446, 105.83083],\r\n[21.03448, 105.83052],\r\n[21.03448, 105.83045],\r\n[21.03449, 105.83027],\r\n[21.03453, 105.82988],\r\n[21.03454, 105.82975],\r\n[21.03454, 105.82963],\r\n[21.03457, 105.82924],\r\n[21.03459, 105.82906],\r\n[21.03461, 105.82883],\r\n[21.03461, 105.82873],\r\n[21.03462, 105.8286],\r\n[21.03463, 105.8285],\r\n[21.03463, 105.82849],\r\n[21.03464, 105.82837],\r\n[21.03465, 105.82828],\r\n[21.03465, 105.82826],\r\n[21.03465, 105.82825],\r\n[21.03466, 105.82809],\r\n[21.03467, 105.82804],\r\n[21.03467, 105.828],\r\n[21.03467, 105.82795],\r\n[21.03468, 105.82789],\r\n[21.0347, 105.8276],\r\n[21.03471, 105.82746],\r\n[21.03472, 105.82733],\r\n[21.03472, 105.82717],\r\n[21.03475, 105.82697],\r\n[21.03476, 105.82678],\r\n[21.03478, 105.82662],\r\n[21.03483, 105.82607],\r\n[21.03484, 105.82599],\r\n[21.03485, 105.82574],\r\n[21.03486, 105.82566],\r\n[21.03487, 105.82559],\r\n[21.03488, 105.82536],\r\n[21.03489, 105.82532],\r\n[21.03489, 105.82526],\r\n[21.0349, 105.82513],\r\n[21.03491, 105.82497],\r\n[21.03491, 105.82493],\r\n[21.03491, 105.82488],\r\n[21.03493, 105.82467],\r\n[21.03494, 105.82457],\r\n[21.03494, 105.82451],\r\n[21.03495, 105.82441],\r\n[21.03497, 105.82411],\r\n[21.03499, 105.8239],\r\n[21.03506, 105.82336],\r\n[21.03506, 105.82329],\r\n[21.03507, 105.82319],\r\n[21.03508, 105.8231],\r\n[21.03509, 105.82297],\r\n[21.03509, 105.82293],\r\n[21.03509, 105.8229],\r\n[21.0351, 105.82279],\r\n[21.0351, 105.82271],\r\n[21.03511, 105.82261],\r\n[21.03513, 105.82235],\r\n[21.03514, 105.8223],\r\n[21.03514, 105.82224],\r\n[21.03514, 105.82222],\r\n[21.03515, 105.82213],\r\n[21.03516, 105.82199],\r\n[21.03516, 105.82196],\r\n[21.03517, 105.82181],\r\n[21.03518, 105.82169],\r\n[21.03519, 105.82156],\r\n[21.03519, 105.82148],\r\n[21.0352, 105.8214],\r\n[21.03523, 105.82101],\r\n[21.03524, 105.82082],\r\n[21.03527, 105.8203],\r\n[21.03527, 105.8203],\r\n[21.03541, 105.82032],\r\n[21.03559, 105.82034],\r\n[21.03613, 105.82038],\r\n[21.03635, 105.8204],\r\n[21.03659, 105.8204],\r\n[21.03685, 105.82043],\r\n[21.03705, 105.82045],\r\n[21.03723, 105.82048],\r\n[21.03856, 105.82064],\r\n[21.03874, 105.82066],\r\n[21.03879, 105.82071],\r\n[21.03882, 105.82076],\r\n[21.03884, 105.82082],\r\n[21.03884, 105.82088],\r\n[21.03884, 105.82095],\r\n[21.03883, 105.82102],\r\n[21.03882, 105.8211],\r\n[21.03881, 105.82119],\r\n[21.0388, 105.82131],\r\n[21.03874, 105.82193],\r\n[21.03873, 105.82211],\r\n[21.0387, 105.82263],\r\n[21.03864, 105.82287],\r\n[21.03844, 105.82336],\r\n[21.03836, 105.82362],\r\n[21.03831, 105.82387],\r\n[21.0383, 105.82391],\r\n[21.03828, 105.82404],\r\n[21.03827, 105.82422],\r\n[21.03827, 105.82436],\r\n[21.03827, 105.82449],\r\n[21.03826, 105.82461],\r\n[21.03825, 105.82471],\r\n[21.03823, 105.82481],\r\n[21.0382, 105.82494],\r\n[21.03818, 105.82501],\r\n[21.03818, 105.82501],\r\n[21.0382, 105.82501],\r\n[21.0382, 105.82501]\r\n];\r\n\r\nfunction updateService(dataTemporary) {\r\n    let id = \"HN1234\";\r\n    for (let i = 0; i < dataTemporary.length; i++) {\r\n        // console.log(dataTemporary[i][0], dataTemporary[i][1]);\r\n        setTimeout(function () {\r\n            $.getJSON(\"/majestic/Dashboard/php/api/post/update_service.php\", {\r\n                id:id,\r\n                lat: dataTemporary[i][0],\r\n                long: dataTemporary[i][1]\r\n            }, function (data) {\r\n                // console.log(data);\r\n            });\r\n\r\n        }, 500*i);\r\n\r\n    }\r\n}\r\nupdateService(dataTemporary);\r\n\r\n// function loadname(){\r\n//     $.getJSON('/majestic/Dashboard/php/api/post/R_temporary.php',{},function (data) {\r\n//         // console.log(data);\r\n//         $(\"#display-username\").text(data[\"username\"]);\r\n//         // $(\"#display-fullname\").text('Welcome back ' + data[\"fullname\"]);\r\n//     });\r\n// }\r\n// window.onload=loadname;\r\n// Define map\r\n\r\nvar cities = L.layerGroup();\r\nvar mLittleton = L.marker([21.1227, 105.7532], { icon: iconRed }).bindPopup('This is Littleton, CO.').addTo(cities);\r\nvar mDenver = L.marker([21.0046, 105.8529], { icon: iconRed }).bindPopup('This is Denver, CO.').addTo(cities);\r\nvar mAurora = L.marker([21.1108, 105.852], { icon: iconRed }).bindPopup('This is Aurora, CO.').addTo(cities);\r\nvar mGolden = L.marker([21.05285, 105.852], { icon: iconRed }).bindPopup('This is Golden, CO.').addTo(cities);\r\n\r\nvar mbAttr = 'Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, Imagery © <a href=\"https://www.mapbox.com/\">Mapbox</a>';\r\nvar mbUrl = 'https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw';\r\n\r\nvar grayscale = L.tileLayer(mbUrl, { id: 'mapbox/light-v9', tileSize: 512, zoomOffset: -1, attribution: mbAttr });\r\nvar streets = L.tileLayer(mbUrl, { id: 'mapbox/streets-v11', tileSize: 512, zoomOffset: -1, attribution: mbAttr });\r\nvar outdoors = L.tileLayer(mbUrl, { id: 'mapbox/outdoors-v11', tileSize: 512, zoomOffset: -1, attribution: mbAttr });\r\n\r\nvar mylayers = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {\r\n    attribution: '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\r\n})\r\nvar googleStreets = L.tileLayer('http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}',{\r\n    maxZoom: 20,\r\n    subdomains:['mt0','mt1','mt2','mt3']\r\n});\r\n// Hybrid: s,h;\r\n// Satellite: s;\r\n// Streets: m;\r\n// Terrain: p;\r\nvar map = L.map('map', {\r\n    center: [21.57201, 105.61388],\r\n    maxZoom: 20,\r\n    layers: [streets]\r\n    // layers: [googleStreets, cities]\r\n});\r\n\r\n// var control = L.Routing.control({\r\n//     waypoints: [\r\n//         L.latLng(21.0419, 105.821),\r\n//         L.latLng(21.0382, 105.825)\r\n//     ],\r\n//     routeWhileDragging: true,\r\n//     // createMarker: function () {\r\n//     //     return null;\r\n//     // }\r\n// }).addTo(map);\r\n\r\nvar xxx = L.polyline(dataTemporary).addTo(map);\r\n\r\nmap.setView([21.037181, 105.833485], 15);\r\n\r\nvar baseLayers = {\r\n    'Grayscale': grayscale,\r\n    'Streets': streets,\r\n    'Outdoors': outdoors,\r\n    'MyLayers': mylayers,\r\n    'Google Streets': googleStreets\r\n};\r\n\r\nvar overlays = {\r\n    'Cities': cities\r\n};\r\n\r\n// var layerControl = L.control.layers(baseLayers, overlays).addTo(map);\r\nvar layerControl = L.control.layers(baseLayers).addTo(map);\r\n\r\nvar iconRed = L.icon({\r\n    iconUrl: './images/red-garbage.png',\r\n    iconSize: [25, 41],\r\n});\r\nvar iconGreen = L.icon({\r\n    iconUrl: './images/green-garbage.png',\r\n    iconSize: [25, 41],\r\n});\r\nvar iconYellow = L.icon({\r\n    iconUrl: './images/yellow-garbage.png',\r\n    iconSize: [25, 41],\r\n});\r\nvar iconVehicleRed = L.icon({\r\n    iconUrl: './images/red-vehicle.png',\r\n    iconSize: [16, 35],\r\n});\r\nvar iconVehicleGreen = L.icon({\r\n    iconUrl: './images/green-vehicle.png',\r\n    iconSize: [16, 35],\r\n});\r\n\r\n(function() {\r\n    // save these original methods before they are overwritten\r\n    var proto_initIcon = L.Marker.prototype._initIcon;\r\n    var proto_setPos = L.Marker.prototype._setPos;\r\n\r\n    var oldIE = (L.DomUtil.TRANSFORM === 'msTransform');\r\n\r\n    L.Marker.addInitHook(function() {\r\n        var iconOptions = this.options.icon && this.options.icon.options;\r\n        var iconAnchor = iconOptions && this.options.icon.options.iconAnchor;\r\n        if (iconAnchor) {\r\n            iconAnchor = (iconAnchor[0] + 'px ' + iconAnchor[1] + 'px');\r\n        }\r\n        this.options.rotationOrigin = this.options.rotationOrigin || iconAnchor || 'center center';\r\n        this.options.rotationAngle = this.options.rotationAngle || 0;\r\n\r\n        // Ensure marker keeps rotated during dragging\r\n        this.on('drag', function(e) { e.target._applyRotation(); });\r\n    });\r\n\r\n    L.Marker.include({\r\n        _initIcon: function() {\r\n            proto_initIcon.call(this);\r\n        },\r\n\r\n        _setPos: function(pos) {\r\n            proto_setPos.call(this, pos);\r\n            this._applyRotation();\r\n        },\r\n\r\n        _applyRotation: function() {\r\n            if (this.options.rotationAngle) {\r\n                this._icon.style[L.DomUtil.TRANSFORM + 'Origin'] = this.options.rotationOrigin;\r\n\r\n                if (oldIE) {\r\n                    // for IE 9, use the 2D rotation\r\n                    this._icon.style[L.DomUtil.TRANSFORM] = 'rotate(' + this.options.rotationAngle + 'deg)';\r\n                    // this._icon.style[L.DomUtil.TRANSITION] = 'all 2s linear';\r\n                } else {\r\n                    // for modern browsers, prefer the 3D accelerated version\r\n                    this._icon.style[L.DomUtil.TRANSFORM] += ' rotateZ(' + this.options.rotationAngle + 'deg)';\r\n                    // this._icon.style[L.DomUtil.TRANSITION] = 'all 2s linear';\r\n                }\r\n            }\r\n        },\r\n\r\n        setRotationAngle: function(angle) {\r\n            this.options.rotationAngle = angle;\r\n            this.update();\r\n            return this;\r\n        },\r\n\r\n        setRotationOrigin: function(origin) {\r\n            this.options.rotationOrigin = origin;\r\n            this.update();\r\n            return this;\r\n        }\r\n    });\r\n})();\r\n\r\n\r\nfunction _getAngle(startx, starty, endx, endy) {\r\n    var tan = 0\r\n    if (endx == startx) {\r\n        tan = 90;\r\n    } else {\r\n        tan = Math.atan(Math.abs((endy - starty) / (endx - startx))) * 180 / Math.PI;\r\n        console.log(tan);\r\n    }\r\n\r\n    if (endx >= startx && endy >= starty) //First quadrant\r\n    {\r\n        return -tan;\r\n    } else if (endx > startx && endy < starty) //Delta Quadrant\r\n    {\r\n        return tan;\r\n    } else if (endx < startx && endy > starty) //Beta Quadrant\r\n    {\r\n        return tan - 180;\r\n    } else {\r\n        return 180 - tan; //third quadrant\r\n    }\r\n}\r\n\r\n\r\nvar statBin = {\r\n    \"full\": iconRed,\r\n    \"empty\": iconGreen,\r\n    \"mid\": iconYellow,\r\n};\r\nvar statVehicle = {\r\n    \"Free\": iconVehicleRed,\r\n    \"On work\": iconVehicleGreen,\r\n};\r\n\r\nobjLatlngs = [];\r\n$.getJSON('/majestic/Dashboard/php/api/post/R_vehicle.php', {}, (data) => {\r\n    let body = document.querySelector(\".table tbody\");\r\n    for (let i = 0; i < data.data.length; i++) {\r\n        let oV = {\r\n            lat: data.data[i].lat,\r\n            long: data.data[i].long,\r\n            angle: 0\r\n        }\r\n        objLatlngs.push(oV);\r\n    }\r\n});\r\n// console.log(objLatlngs);\r\n\r\nvar objBin = [];\r\nvar objVehicle = [];\r\nvar layerGrBin, layerGrVehicle;\r\nvar oB = new Object();\r\nvar oV = new Object();\r\nsetInterval(function() {\r\n    objBin = [];\r\n    $.getJSON('/majestic/Dashboard/php/api/post/R_bin.php', {}, (data) => {\r\n        \r\n        for (let i = 0; i < data.data.length; i++) {\r\n            oB = {\r\n                lat: data.data[i].lat,\r\n                long: data.data[i].long,\r\n                markerBin: L.marker([data.data[i].lat, data.data[i].long]).bindPopup(\r\n                \"ID: \"+data.data[i].id +\"<br>\" +\r\n                \"addresses: \"+data.data[i].addresses +\"<br>\" +\r\n                \"createddate: \"+data.data[i].createddate +\"<br>\" +\r\n                \"lat: \"+data.data[i].lat +\"<br>\" +\r\n                \"long: \"+data.data[i].long +\"<br>\" +\r\n                \"statuses: \"+data.data[i].statuses +\"<br>\"\r\n                ).openPopup()\r\n            };\r\n            oB.markerBin.setIcon(statBin[data.data[i].statuses]);\r\n            objBin.push(oB.markerBin);\r\n        }\r\n    });\r\n    objVehicle = [];\r\n    $.getJSON('/majestic/Dashboard/php/api/post/R_vehicle.php', {}, (data) => {\r\n        // console.log(data);\r\n        let body = document.querySelector(\".table tbody\");\r\n        for (let i = 0; i < data.data.length; i++) {\r\n            oV = {\r\n                lat: data.data[i].lat,\r\n                long: data.data[i].long,\r\n                markerVehicle: L.marker([data.data[i].lat, data.data[i].long]).bindPopup(\r\n                \"ID: \"+data.data[i].id +\"<br>\" +\r\n                // \"typed: \"+data.data[i].typed +\"<br>\" +\r\n                \"license: \"+data.data[i].license +\"<br>\" +\r\n                // \"code: \"+data.data[i].code +\"<br>\" +\r\n                \"lat: \"+data.data[i].lat +\"<br>\" +\r\n                \"long: \"+data.data[i].long +\"<br>\" +\r\n                \"addresses: \"+data.data[i].addresses +\"<br>\" +\r\n                \"statuses: \"+data.data[i].statuses +\"<br>\"\r\n                ).openPopup()\r\n            }\r\n            oV.markerVehicle.setIcon(statVehicle[data.data[i].statuses]);\r\n            objVehicle.push(oV.markerVehicle);\r\n        }\r\n    });\r\n    setTimeout(function() {\r\n        for (let i = 0; i < objVehicle.length; i++) {\r\n            if (objVehicle[i]._latlng.lat !== objLatlngs[i].lat || objVehicle[i]._latlng.lng !== objLatlngs[i].long) {\r\n                let angle = _getAngle(objLatlngs[i].long, objLatlngs[i].lat, objVehicle[i]._latlng.lng, objVehicle[i]._latlng.lat);\r\n                // objVehicle[i].setRotationAngle(angle);\r\n                // objVehicle[i].setRotationOrigin(16 + 'px ' + 35 + 'px');\r\n                objLatlngs[i].angle = angle;\r\n                objLatlngs[i].lat = objVehicle[i]._latlng.lat;\r\n                objLatlngs[i].long = objVehicle[i]._latlng.lng;\r\n                console.log(\"Update\");\r\n            }\r\n            if (objVehicle[i].options.rotationAngle == 0) {\r\n                objVehicle[i].setRotationAngle(objLatlngs[i].angle);\r\n                objVehicle[i].setRotationOrigin(16 + 'px ' + 35 + 'px');\r\n            }\r\n            console.log(objVehicle[i].options.rotationAngle);\r\n        }\r\n        if (layerGrBin) {\r\n            map.removeLayer(layerGrBin);\r\n        }\r\n        if (layerGrVehicle) {\r\n            map.removeLayer(layerGrVehicle);\r\n        }\r\n        layerGrBin = L.layerGroup(objBin).addTo(map);\r\n        layerGrVehicle = L.layerGroup(objVehicle).addTo(map);\r\n        \r\n    }, 200);\r\n}, 500);\r\n\r\n"
        }
    ]
}